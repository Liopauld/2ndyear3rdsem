<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>GadgetEssence - Manage Users</title>
    
    <!-- Bootstrap CSS -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"
      integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm"
      crossorigin="anonymous"
    />

    <!-- DataTables CSS -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/datatables/1.10.21/css/dataTables.bootstrap4.min.css"
      integrity="sha512-PT0RvABaDhDQugEbpNMwgYBCnGCiTZMh9yOzUsJHDgl/dMhD9yjHAwoumnUk3JydV3QTcIkNDuN40CJxik5+WQ=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />
    
    <!-- Font Awesome -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
      crossorigin="anonymous"
    />
    
    <!-- DataTables Buttons CSS -->
    <link
      href="https://cdn.datatables.net/buttons/2.3.5/css/buttons.dataTables.min.css"
      rel="stylesheet"
    />

    <!-- SweetAlert2 CSS -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/sweetalert2/11.16.1/sweetalert2.css"
      integrity="sha512-fjO3Vy3QodX9c6G9AUmr6WuIaEPdGRxBjD7gjatG5gGylzYyrEq3U0q+smkG6CwIY0L8XALRFHh4KPHig0Q1ug=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />
    
    <!-- Custom CSS -->
    <link rel="stylesheet" href="css/style.css" />
    <!-- jQuery -->
    <script
      src="https://code.jquery.com/jquery-3.6.4.min.js"
      integrity="sha256-oP6HI9z1XaZNBrJURtCoUT5SUnxFr8s3BzRl+cbzUq8="
      crossorigin="anonymous"
    ></script>
    
    <!-- Bootstrap JS -->
    <script
      src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js"
      integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js"
      integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
      crossorigin="anonymous"
    ></script>
    
    <!-- DataTables JS -->
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/datatables/1.10.21/js/jquery.dataTables.min.js"
      integrity="sha512-BkpSL20WETFylMrcirBahHfSnY++H2O1W+UnEEO4yNIl+jI2+zowyoGJpbtk6bx97fBXf++WJHSSK2MV4ghPcg=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    ></script>
    <script
      type="text/javascript"
      src="https://cdn.datatables.net/1.10.22/js/dataTables.bootstrap4.min.js"
    ></script>
    <script
      type="text/javascript"
      src="https://cdn.datatables.net/buttons/1.6.5/js/dataTables.buttons.min.js"
    ></script>
    <script
      type="text/javascript"
      src="https://cdn.datatables.net/buttons/1.6.5/js/buttons.bootstrap4.min.js"
    ></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/pdfmake.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.32/vfs_fonts.js"></script>
    <script src="https://cdn.datatables.net/buttons/2.3.5/js/buttons.html5.min.js"></script>


    
    <!-- SweetAlert2 JS -->
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/sweetalert2/11.16.1/sweetalert2.min.js"
      integrity="sha512-LGHBR+kJ5jZSIzhhdfytPoEHzgaYuTRifq9g5l6ja6/k9NAOsAi5dQh4zQF6JIRB8cAYxTRedERUF+97/KuivQ=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    ></script>

    <!-- Custom JS -->
    <script src="js/user.js"></script>
    <script src="js/auth-checker.js"></script>
    <script src="js/refresh-utility.js"></script>
  </head>
  <body>
    <div id="header"></div>
    <script>
      $("#header").load("header.html", function() {
        if (!sessionStorage.getItem('userId')) {
          // Hide Profile menu if not logged in
          $('a.nav-link[href="profile.html"]').closest('.nav-item').hide();
          // Show Register and Login
          $('a.nav-link[href="register.html"]').closest('.nav-item').show();
          $('a.nav-link[href="login.html"]').closest('.nav-item').show();
        } else {
          // If logged in, show Profile, hide Register, change Login to Logout
          $('a.nav-link[href="profile.html"]').closest('.nav-item').show();
          $('a.nav-link[href="register.html"]').closest('.nav-item').hide();
          const $loginLink = $('a.nav-link[href="login.html"]');
          $loginLink.text('Logout').attr({ 'href': '#', 'id': 'logout-link' }).on('click', function (e) {
            e.preventDefault();
            sessionStorage.clear();
            window.location.href = 'login.html';
          });
        }
      });
    </script>
    
    <div class="container gadget-admin-container" id="adminUsersContainer">
      <h1 class="mb-4 gadget-admin-title">
        <i class="fas fa-users" style="color: #00d4ff; margin-right: 15px;"></i>
        Manage Users
        <small class="d-block" style="font-size: 0.6em; color: #7f8c8d; margin-top: 5px;">Admin - User Management & Customer Accounts</small>
      </h1>
      
      <!-- Export Actions Section -->
      <div class="row mb-4">
        <div class="col-12">
          <div class="gadget-admin-actions-bar">
            <div class="gadget-admin-info">
              <i class="fas fa-info-circle me-2"></i>
              <span>Manage user accounts, roles, and status</span>
            </div>
            <div class="gadget-export-actions">
              <button type="button" class="btn gadget-btn-export" id="exportUsersPDF">
                <i class="fas fa-file-pdf me-2"></i>
                Export PDF
              </button>
              <button type="button" class="btn gadget-btn-export" id="exportUsersExcel">
                <i class="fas fa-file-excel me-2"></i>
                Export Excel
              </button>
            </div>
          </div>
        </div>
      </div>
      
      <div class="gadget-admin-table-container">
        <div class="table-responsive">
          <table id="utable" class="table table-hover gadget-admin-table">
            <thead>
              <tr>
                <th><i class="fas fa-image"></i> Avatar</th>
                <th><i class="fas fa-envelope"></i> Email</th>
                <th><i class="fas fa-user"></i> Last Name</th>
                <th><i class="fas fa-user"></i> First Name</th>
                <th><i class="fas fa-toggle-on"></i> Status</th>
                <th><i class="fas fa-user-shield"></i> Role</th>
                <th><i class="fas fa-cogs"></i> Action</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </div>
    </div>
    <!-- Modal for edit user/customer -->
    <div class="modal fade gadget-modal" id="userModal" tabindex="-1" role="dialog">
      <div class="modal-dialog modal-md" role="document">
        <div class="modal-content gadget-modal-content">
          <div class="modal-header gadget-modal-header">
            <h5 class="modal-title">
              <i class="fas fa-user-edit"></i> Edit User Status/Role
            </h5>
            <button type="button" class="close gadget-modal-close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body gadget-modal-body">
            <form id="uform" class="gadget-form">
              <input type="hidden" id="user_id" name="user_id" />
              <div class="form-group">
                <label for="status" class="control-label gadget-label">
                  <i class="fas fa-toggle-on"></i> Status
                </label>
                <select class="form-control gadget-select" id="status" name="status" style="height: 45px; padding: 8px 12px;">
                  <option value="active">Active</option>
                  <option value="inactive">Inactive</option>
                </select>
              </div>
              <div class="form-group">
                <label for="role" class="control-label gadget-label">
                  <i class="fas fa-user-shield"></i> Role
                </label>
                <select class="form-control gadget-select" id="role" name="role" style="height: 45px; padding: 8px 12px;">
                  <option value="user">User</option>
                  <option value="admin">Admin</option>
                </select>
              </div>
            </form>
          </div>
          <div class="modal-footer gadget-modal-footer">
            <button type="button" class="btn gadget-btn-secondary" data-dismiss="modal">
              <i class="fas fa-times"></i> Cancel
            </button>
            <button id="userUpdate" type="button" class="btn gadget-btn-primary">
              <i class="fas fa-save"></i> Update User
            </button>
          </div>
        </div>
      </div>
    </div>
  </body>
</html>
